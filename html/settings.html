$def with (valid_credentials, valid_regions, current_region)
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="Wormhole admin interface">

    <title>Settings | Wormhole</title>

	<link rel="stylesheet" href="/static/css/pure-min.css">
	<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
	<link rel="stylesheet" href="/static/css/baby-blue.css">
	<link rel="stylesheet" href="/static/css/wormhole.css">
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
</head>

<body>

<div class="pure-g-r" id="layout">
    <a href="#menu" id="menuLink" class="pure-menu-link">
    <span></span>
	</a>

	$:make_menu('settings')

    <div class="pure-u-1" id="main">

		<div class="header">
		    <h1>Settings</h1>		  
		    <h2>Amazon credentials &amp; preferred region.</h2>		  
		</div>

		<div class="content">		

		<form class="pure-form pure-form-aligned" id="settings-form" method="POST">		
			<fieldset>
				<legend>Amazon Web Services Credentials <span id="credentials-error"><i class="fa fa-exclamation-triangle"></i> Invalid credentials</span></legend>
				
$if valid_credentials>0:
	<div class="pure-control-group">
		<label for="access_key">Access Key</label>
		<input id="access_key" class="pure-input-1-2" name="access_key" type="text" placeholder="">
	</div>

	<div class="pure-control-group">
		<label for="secret_key">Secret Key</label>
		<input id="secret_key" class="pure-input-1-2" name="secret_key" type="text" placeholder="">
	</div>		
        
$else:
	<div><span class="control-group-message-success" id="credentials-verified"><i class="fa fa-check-circle "></i> AWS Credentials confirmed</span></div>
	<div id="change-credentials-msg">Need to change your credentials? <a href="#" id="delete_credentials">Click here to delete them</a>.</div>
	<input id="access_key" name="access_key" type="hidden" value=""/>
	<input id="secret_key" name="secret_key" type="hidden" value=""/>	
	<div class="pure-control-group">
		<label for="save_credentials">&nbsp;</label>
		<!-- <button type="submit" id="delete_credentials" class="pure-button pure-button-primary">Delete Credentials</button> -->
	</div>

	<script type="text/javascript">
	$$(function(){
		$$('#delete_credentials').click(function(){
			$$('#access_key').val('DELETE');
			$$('#secret_key').val('DELETE');
			$$('#settings-form').submit();
			return false;
		});
	});
	</script>

</fieldset>

		    <fieldset>
				<legend>Output Region <span id="region-error"><i class="fa fa-exclamation-triangle"></i> Please select a region</span></legend>
				
				$for (val, label) in valid_regions:
					$ selected = ""
					$if val==current_region:
						$ selected = " checked=\"true\""					
					<div class="region_choice"><input type="radio" id="region-radio" name="region" value="$val"$:(selected)><span>$label</span></div>
		    </fieldset>

			<div class="pure-control-group">
				<label for="submit_form">&nbsp;</label>
				<button type="submit" id="submit_form" class="pure-button pure-button-primary">Verify &amp; Save</button><img src="/static/img/loadinfo.gif" alt="ajax loading indicator" id="credential-check-spinner" />
			</div>
		</form>


	<script type="text/javascript">
	$$(function(){
		$$('#submit_form').click(function(event) {
			var all_clear = true;
			event.preventDefault();
			$$('#submit_form').addClass('pure-button-disabled');
			$$('#credentials-success').hide();
			$$('#credentials-error').hide();			
			$$('#credential-check-spinner').show();	

			if($$('#region-radio:checked').length==0){
				$$('#region-error').fadeIn();
				all_clear = false;
			}

			$$.post('/ajax/validate', {'access_key': $$('#access_key').val(), 'secret_key': $$('#secret_key').val()}, function(result) {
				$$('#credential-check-spinner').hide();
				if(!result.success){
					all_clear = false;									
					$$('#credentials-error').fadeIn();
				}
				if(all_clear){
					$$('#settings-form').submit();					
				}
				else {
					$$('#submit_form').removeClass('pure-button-disabled');
				}
			});
		});
	});
	</script>


    	</div>
    </div>
</div>

</body>
</html>